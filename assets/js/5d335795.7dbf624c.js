"use strict";(self.webpackChunkblog_never_del=self.webpackChunkblog_never_del||[]).push([[387],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=o.createContext({}),i=function(e){var n=o.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=i(e.components);return o.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=i(t),m=r,k=d["".concat(p,".").concat(m)]||d[m]||u[m]||a;return t?o.createElement(k,l(l({ref:n},c),{},{components:t})):o.createElement(k,l({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,l=new Array(a);l[0]=d;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var i=2;i<a;i++)l[i]=t[i];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},7561:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>i});var o=t(7462),r=(t(7294),t(3905));const a={sidebar_position:2930,title:"\ud83c\udfaa\ud83c\udfaa\ud83d\udc2c\u2638\ufe0f\u2638\ufe0f3\ufe0f\u20e3 STO \u279c Demo"},l="Storage \u2736 Demo",s={unversionedId:"\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c\u279c Demo",id:"\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c\u279c Demo",title:"\ud83c\udfaa\ud83c\udfaa\ud83d\udc2c\u2638\ufe0f\u2638\ufe0f3\ufe0f\u20e3 STO \u279c Demo",description:"\ud83d\udd35 Must Know",source:"@site/docs/\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c\u279c Demo.md",sourceDirName:".",slug:"/\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c\u279c Demo",permalink:"/\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c\u279c Demo",draft:!1,tags:[],version:"current",sidebarPosition:2930,frontMatter:{sidebar_position:2930,title:"\ud83c\udfaa\ud83c\udfaa\ud83d\udc2c\u2638\ufe0f\u2638\ufe0f3\ufe0f\u20e3 STO \u279c Demo"},sidebar:"defaultSidebar",previous:{title:"\ud83c\udfaa\ud83c\udfaa\ud83d\udc2c\u2638\ufe0f\u2638\ufe0f3\ufe0f\u20e3 STO \u279c Basic",permalink:"/\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-3\ufe0f\u20e3 STO \u279c  Basic"},next:{title:"\ud83c\udfaa\ud83c\udfaa\ud83d\udc2c\u2638\ufe0f\u2638\ufe0f5\ufe0f\u20e3 NET \u279c Basic",permalink:"/\ud83c\udfaa\ud83c\udfaa \ud83d\udc2c\u2638\ufe0f\u2638\ufe0f-5\ufe0f\u20e3 NET \u279c"}},p={},i=[],c={toc:i};function u(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"storage--demo"},"Storage \u2736 Demo"),(0,r.kt)("p",null,"\ud83d\udd35 Must Know "),(0,r.kt)("p",null,"  \ud83d\udd36 rbd vs nfs "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"most cluster storage use rbd / nfs\n    - rbd is for one machine/pod \n    - nfs if for lot machine/pod \n")),(0,r.kt)("p",null,"  \ud83d\udd36 pvc VS volume-folder "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"we use rbd \n  \u279c means one pod need one pvc!\n  \u279c need create a lot pvc! \n\n  \u279c means every folder you mount to docker/docker-compose\n    you need create a pvc in k8s.\n\n  pvc is like volume-folder.\n      you delete pod. pvc still there.\n      but you delete pvc. all data gone.\n")),(0,r.kt)("p",null,"  \ud83d\udd36 PV / StorageCass"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  pv just like a hardware disk.\n  you just need decide which disk to use.\n    there are lots kinds of disk -.- \n\n      - prod disk\n      - test disk\n\n      - fast disk \n      - slow disk \n\n      - backup-yes disk \n      - backup-no  disk  \n")),(0,r.kt)("p",null,"  \ud83d\udd36 PV & PVC "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  PV:   like formated disk. \n  PVC:  like folder \n\n        pv & pvc is same to you .\n        you delete pvc. it maybe auto delete pv for you.\n            - depends is storage support this function \n")),(0,r.kt)("p",null,"  \ud83d\udd36 StorageCass & real storage cluster "),(0,r.kt)("p",null,"\ud83d\udd35 How PVC Work "),(0,r.kt)("p",null,"  you create pvc.\n\ud83d\udd25 k8s auto create pv. & bond to your pvc."),(0,r.kt)("p",null,"  you crteate pod & use    pvc "),(0,r.kt)("p",null,"  you delete  pod & delete pvc",(0,r.kt)("br",{parentName:"p"}),"\n","you no need keep data, so you  delete your pvc.\nif you need keep data, never   delete your pvc.\n\ud83d\udd25 k8s maybe auto delete pv for you !!!!!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"              - depends is storage support this function \n")),(0,r.kt)("p",null,"\ud83d\udd35 StorageClass config "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"StorageClass decide what kind of disk/pv  user can use. \n\nStorageClass is bond to storage cluster pool. \n  diffeent pool have different config. \n    how config storageclass depends on your pool conig.\n\nyou no need much kind of disk/storageclass.\n\n    SC-Test.0 \u279c Test pool    \u279c  Normal disk with  0 copy  backup \n    SC-Prod.2 \u279c Prod pool    \u279c  Normal disk with  2 copy  backup\n    SC-DB     \u279c DB pool      \u279c  high performace disk \n")),(0,r.kt)("p",null,"\ud83d\udd35 PVC  vs  Volume_folder "),(0,r.kt)("p",null,"  in docker \u279c  volume is a folder  on host.\nin k8s    \u279c  pvc    is a rbd disk on pod (not on host)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  in docker you can creat folder/file for volume very easy.\n      it is local\n  \n  in k8s. you can only visit pvc folder in pod!\n      it is rbd disk.\n        rbd means one disk only allow one pod to use.\n          some pods can not start without some config file.\n              you have to mount pvc to other pod in order to put file in pvc.\n                -.-\n")),(0,r.kt)("p",null,"\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\n\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35 misc\n\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35"),(0,r.kt)("p",null,"\ud83d\udd35 PV Access Modes \u2705"),(0,r.kt)("p",null,"  \u25ce RWO  ReadWriteOnce\n\u25ce ROX  ReadOnlyMany\n\u25ce RWX  ReadWriteMany  "),(0,r.kt)("p",null,"  Access Modes is how disk can mount to node."),(0,r.kt)("p",null,"  most common is RWO:",(0,r.kt)("br",{parentName:"p"}),"\n","disk mount to one node only. that node can read and write data."),(0,r.kt)("p",null,"  many storage like ceph support ROX:\nDisk can mount to many node, but only one node can write."),(0,r.kt)("p",null,"  less storage support RWX:\ndisk can mount to many node. all node can read and write! "),(0,r.kt)("p",null,"  not all storage support three above mode.\n\u203c\ufe0f ceph-csi only support RWO ROX.  No RWX  \u203c\ufe0f\n\u203c\ufe0f ceph-csi only support RWO ROX.  No RWX  \u203c\ufe0f\n\u203c\ufe0f ceph-csi only support RWO ROX.  No RWX  \u203c\ufe0f"),(0,r.kt)("p",null,"==\n\ud83d\udd35 RBD-Pod Volume set"),(0,r.kt)("p",null,"  pod "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},">> spec \n  >> container. \n    >> VolumeDevice      # \u203c\ufe0f  this means usd rbd type storage          \n      - name: KeepWeSame # \u203c\ufe0fset volume to use. name is just blow 3 line. must keep same\n      - devicepaths      #  Path into Docker\n")),(0,r.kt)("p",null,"  pod "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},">> spec \n  >> volumes:\n    - name: KeepWeSame\n")),(0,r.kt)("p",null,"\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\n\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\n\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35\ud83d\udd35"),(0,r.kt)("p",null,"\ud83d\udd35 one pvc . mount many folder. \u2705 "),(0,r.kt)("p",null,"  apiVersion: v1\nkind: Pod\nmetadata:\nname: test\nspec:\ncontainers:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  - name: test\n    image: nginx\n    volumeMounts:\n      # \u7f51\u7ad9\u6570\u636e\u6302\u8f7d\n      - name: config\n        mountPath: /usr/share/nginx/html\n        subPath: html\n      # Nginx \u914d\u7f6e\u6302\u8f7d\n      - name: config\n        mountPath: /etc/nginx/nginx.conf\n        subPath: nginx.conf\nvolumes:\n  - name: config\n    persistentVolumeClaim:\n      claimName: test-nfs-claim\n")))}u.isMDXComponent=!0}}]);